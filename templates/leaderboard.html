{% extends "base.html" %}

{% block title %}Leaderboard - ArtAI{% endblock %}

{% block content %}
<div class="container py-5">
    <!-- Header -->
    <div class="text-center mb-5">
        <h1 class="display-4 fw-bold">üèÜ Leaderboard</h1>
        <p class="lead text-muted">Top artists and their achievements</p>
    </div>
    
    <!-- Category Tabs -->
    <ul class="nav nav-pills nav-fill mb-4" id="leaderboardTabs" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="experience-tab" data-bs-toggle="pill" data-bs-target="#experience" type="button">
                <i class="fas fa-star me-2"></i>Top Experience
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="artworks-tab" data-bs-toggle="pill" data-bs-target="#artworks" type="button">
                <i class="fas fa-palette me-2"></i>Most Uploads
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="liked-tab" data-bs-toggle="pill" data-bs-target="#liked" type="button">
                <i class="fas fa-heart me-2"></i>Most Liked
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="streaks-tab" data-bs-toggle="pill" data-bs-target="#streaks" type="button">
                <i class="fas fa-fire me-2"></i>Longest Streaks
            </button>
        </li>
    </ul>
    
    <!-- Tab Content -->
    <div class="tab-content" id="leaderboardContent">
        <!-- Experience Leaders -->
        <div class="tab-pane fade show active" id="experience" role="tabpanel">
            <div class="row">
                {% for user in top_artists[:3] %}
                <div class="col-md-4 mb-4">
                    <div class="card leader-card {% if loop.index == 1 %}gold{% elif loop.index == 2 %}silver{% else %}bronze{% endif %}">
                        <div class="card-body text-center">
                            <div class="rank-badge">
                                {% if loop.index == 1 %}
                                    <i class="fas fa-crown fa-2x text-warning"></i>
                                {% elif loop.index == 2 %}
                                    <i class="fas fa-medal fa-2x text-secondary"></i>
                                {% else %}
                                    <i class="fas fa-award fa-2x" style="color: #cd7f32;"></i>
                                {% endif %}
                                <div class="rank-number">#{{ loop.index }}</div>
                            </div>
                            <h5 class="mt-3">{{ user.username }}</h5>
                            <p class="text-muted">Level {{ user.level }}</p>
                            <div class="stat-highlight">
                                <span class="badge bg-primary fs-6">{{ user.experience }} XP</span>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            
            <!-- Rest of the list -->
            {% if top_artists|length > 3 %}
            <div class="card">
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th>Rank</th>
                                    <th>Artist</th>
                                    <th>Level</th>
                                    <th>Experience</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for user in top_artists[3:] %}
                                <tr>
                                    <td><span class="badge bg-light text-dark">{{ loop.index + 3 }}</span></td>
                                    <td>
                                        <a href="{{ url_for('user_profile', username=user.username) }}" class="text-decoration-none">
                                            {{ user.username }}
                                        </a>
                                    </td>
                                    <td>{{ user.level }}</td>
                                    <td><span class="badge bg-primary">{{ user.experience }} XP</span></td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            {% endif %}
        </div>
        
        <!-- Upload Leaders -->
        <div class="tab-pane fade" id="artworks" role="tabpanel">
            <div class="card">
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th>Rank</th>
                                    <th>Artist</th>
                                    <th>Artworks</th>
                                    <th>Level</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for user, stats in top_uploaders %}
                                <tr>
                                    <td>
                                        <span class="badge {% if loop.index <= 3 %}bg-warning{% else %}bg-light text-dark{% endif %}">
                                            {{ loop.index }}
                                        </span>
                                    </td>
                                    <td>
                                        <a href="{{ url_for('user_profile', username=user.username) }}" class="text-decoration-none">
                                            {{ user.username }}
                                        </a>
                                    </td>
                                    <td><span class="badge bg-success">{{ stats.total_artworks }}</span></td>
                                    <td>{{ user.level }}</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Most Liked -->
        <div class="tab-pane fade" id="liked" role="tabpanel">
            <div class="card">
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th>Rank</th>
                                    <th>Artist</th>
                                    <th>Total Likes</th>
                                    <th>Level</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for user, stats in top_liked %}
                                <tr>
                                    <td>
                                        <span class="badge {% if loop.index <= 3 %}bg-warning{% else %}bg-light text-dark{% endif %}">
                                            {{ loop.index }}
                                        </span>
                                    </td>
                                    <td>
                                        <a href="{{ url_for('user_profile', username=user.username) }}" class="text-decoration-none">
                                            {{ user.username }}
                                        </a>
                                    </td>
                                    <td><span class="badge bg-danger">{{ stats.total_likes_received }}</span></td>
                                    <td>{{ user.level }}</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Streak Leaders -->
        <div class="tab-pane fade" id="streaks" role="tabpanel">
            <div class="card">
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th>Rank</th>
                                    <th>Artist</th>
                                    <th>Longest Streak</th>
                                    <th>Current Streak</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for user, stats in top_streaks %}
                                <tr>
                                    <td>
                                        <span class="badge {% if loop.index <= 3 %}bg-warning{% else %}bg-light text-dark{% endif %}">
                                            {{ loop.index }}
                                        </span>
                                    </td>
                                    <td>
                                        <a href="{{ url_for('user_profile', username=user.username) }}" class="text-decoration-none">
                                            {{ user.username }}
                                        </a>
                                    </td>
                                    <td><span class="badge bg-warning">{{ stats.longest_streak }} days</span></td>
                                    <td><span class="badge bg-info">{{ stats.daily_streak }} days</span></td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.leader-card {
    transition: all 0.3s ease;
    border: 2px solid transparent;
}

.leader-card.gold {
    border-color: #ffd700;
    box-shadow: 0 4px 20px rgba(255, 215, 0, 0.3);
}

.leader-card.silver {
    border-color: #c0c0c0;
    box-shadow: 0 4px 20px rgba(192, 192, 192, 0.3);
}

.leader-card.bronze {
    border-color: #cd7f32;
    box-shadow: 0 4px 20px rgba(205, 127, 50, 0.3);
}

.leader-card:hover {
    transform: translateY(-5px);
}

.rank-badge {
    position: relative;
    display: inline-block;
}

.rank-number {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-weight: bold;
    font-size: 0.8rem;
    color: white;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
}

.stat-highlight {
    margin-top: 1rem;
}

.nav-pills .nav-link {
    color: #6c757d;
    background: transparent;
    border: 1px solid #dee2e6;
    margin: 0 2px;
}

.nav-pills .nav-link.active {
    background: linear-gradient(45deg, #007bff, #0056b3);
    border-color: #0056b3;
}

.table th {
    border-top: none;
    background: #f8f9fa;
    font-weight: 600;
}
</style>
{% endblock %}